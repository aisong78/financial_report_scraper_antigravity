# ğŸ“Š Antigravity æ™ºèƒ½è´¢æŠ¥åˆ†æç³»ç»Ÿ

> åŸºäº Python + Streamlit + AkShare æ„å»ºçš„å…¨æ ˆè´¢åŠ¡æ•°æ®åˆ†æå·¥å…·  
> æ”¯æŒ Aè‚¡ã€æ¸¯è‚¡ã€ç¾è‚¡çš„è´¢æŠ¥æ•°æ®æŠ“å–ã€è§£æã€éªŒè¯ä¸å¯è§†åŒ–

[![Python](https://img.shields.io/badge/Python-3.11-blue.svg)](https://www.python.org/)
[![Streamlit](https://img.shields.io/badge/Streamlit-1.28-red.svg)](https://streamlit.io/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ“ˆ æ•°æ®æŠ“å–
- **å¤šå¸‚åœºæ”¯æŒ**: Aè‚¡ï¼ˆAkShareï¼‰ã€æ¸¯è‚¡ï¼ˆå·¨æ½®èµ„è®¯ï¼‰ã€ç¾è‚¡ï¼ˆSEC Edgarï¼‰
- **ç»“æ„åŒ–æ•°æ®**: è‡ªåŠ¨æŠ“å–åˆ©æ¶¦è¡¨ã€èµ„äº§è´Ÿå€ºè¡¨ã€ç°é‡‘æµé‡è¡¨
- **PDF åŸæ–‡ä¸‹è½½**: ä¸€é”®ä¸‹è½½å¹¶è§£æè´¢æŠ¥ PDFï¼Œä¿å­˜ä¸º TXT ä¾›åç»­åˆ†æ

### ğŸ§® æ™ºèƒ½è®¡ç®—
- **è‡ªåŠ¨åŒ–æŒ‡æ ‡è®¡ç®—**: ROEã€æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡ã€å¢é•¿ç‡ç­‰ 15+ æ ¸å¿ƒæŒ‡æ ‡
- **åŒæ¯”åˆ†æ**: è‡ªåŠ¨è®¡ç®— YoY å¢é•¿ç‡ï¼Œè¯†åˆ«è¶‹åŠ¿å˜åŒ–
- **è´¨é‡éªŒè¯**: äº¤å‰éªŒè¯ AkShare æ•°æ®ä¸ PDF åŸæ–‡ï¼Œç¡®ä¿å‡†ç¡®æ€§

### ğŸ“Š æ•°æ®å¯è§†åŒ–
- **å…¨ä¸­æ–‡ç•Œé¢**: æŒ‡æ ‡åç§°ã€å•ä½ã€æ ¼å¼åŒ–æ•°å­—ä¸€ç›®äº†ç„¶
- **åŠ¨æ€ç­›é€‰**: æŒ‰æŠ¥å‘Šç±»å‹ï¼ˆå¹´æŠ¥/å­£æŠ¥ï¼‰ç­›é€‰æ•°æ®
- **é€è§†è¡¨å±•ç¤º**: æ—¶é—´ä¸ºæ¨ªè½´ï¼ŒæŒ‡æ ‡ä¸ºçºµè½´ï¼Œä¾¿äºçºµå‘å¯¹æ¯”

### ğŸ” æ•°æ®è´¨é‡ä¿éšœ
- **äº¤å‰éªŒè¯å¼•æ“**: è‡ªåŠ¨å¯¹æ¯” AkShare æ•°æ®ä¸ PDF åŸæ–‡çš„å…³é”®æ•°å­—
- **è´¨é‡æ ‡è®°**: `VERIFIED`ï¼ˆå·²éªŒè¯ï¼‰ã€`UNVERIFIED`ï¼ˆæœªéªŒè¯ï¼‰ã€`CONFLICT`ï¼ˆå†²çªï¼‰
- **å·®å¼‚æŠ¥å‘Š**: è¯¦ç»†è®°å½•æ¯ä¸ªå­—æ®µçš„å¯¹æ¯”ç»“æœå’Œå·®å¼‚ç™¾åˆ†æ¯”

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.11+
- Condaï¼ˆæ¨èï¼‰

### å®‰è£…æ­¥éª¤

1. **å…‹éš†ä»“åº“**
```bash
git clone https://github.com/aisong78/financial_report_scraper_antigravity.git
cd financial_report_scraper_antigravity
```

2. **åˆ›å»º Conda ç¯å¢ƒ**
```bash
conda create -n finance python=3.11
conda activate finance
```

3. **å®‰è£…ä¾èµ–**
```bash
pip install -r requirements.txt
```

4. **åˆå§‹åŒ–æ•°æ®åº“**
```bash
python database.py
```

5. **è¿è¡Œåº”ç”¨**
```bash
streamlit run app.py
```

åº”ç”¨ä¼šè‡ªåŠ¨åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `http://localhost:8501`

---

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. æŸ¥çœ‹è´¢åŠ¡æ•°æ®
1. åœ¨ä¾§è¾¹æ é€‰æ‹©è‚¡ç¥¨ä»£ç ï¼ˆé»˜è®¤æœ‰èŒ…å°ã€å®¹ç™¾ç§‘æŠ€ç­‰ï¼‰
2. ç‚¹å‡»"åŠ è½½/åˆ·æ–°æ•°æ®"æŒ‰é’®
3. åœ¨ä¸»ç•Œé¢æŸ¥çœ‹ï¼š
   - **æ ¸å¿ƒè´¢åŠ¡æŒ‡æ ‡**ï¼šROEã€æ¯›åˆ©ç‡ã€å¢é•¿ç‡ç­‰
   - **åŸå§‹è´¢åŠ¡æŠ¥è¡¨**ï¼šåˆ©æ¶¦è¡¨ã€èµ„äº§è´Ÿå€ºè¡¨ã€ç°é‡‘æµé‡è¡¨

### 2. ç­›é€‰æ•°æ®
- ä½¿ç”¨"åªçœ‹å“ªç§æŠ¥è¡¨ï¼Ÿ"ä¸‹æ‹‰èœå•ç­›é€‰ç‰¹å®šç±»å‹çš„è´¢æŠ¥
- æ”¯æŒï¼šå…¨éƒ¨ã€å¹´æŠ¥ (A)ã€ä¸‰å­£æŠ¥ (Q3)ã€åŠå¹´æŠ¥ (S1)ã€ä¸€å­£æŠ¥ (Q1)

### 3. ä¸‹è½½è´¢æŠ¥åŸæ–‡
```python
from pdf_downloader import PDFDownloader

downloader = PDFDownloader()
# ä¸‹è½½å®¹ç™¾ç§‘æŠ€æœ€è¿‘ 3 å¹´çš„è´¢æŠ¥
downloader.download("688005", lookback_days=365*3)
```

### 4. æ•°æ®éªŒè¯
```python
from validator import FinancialDataValidator

validator = FinancialDataValidator()
result = validator.validate_report("688005", "2023-12-31")
print(f"éªŒè¯çŠ¶æ€: {result['status']}")
print(f"è¯¦ç»†ç»“æœ: {result['details']}")
```

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Streamlit UI   â”‚  â† ç”¨æˆ·ç•Œé¢
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ app.py  â”‚  â† ä¸»åº”ç”¨é€»è¾‘
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ•°æ®è·å–å±‚               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â–¶ data_fetcher.py        â”‚ â† AkShare API è°ƒç”¨
    â”‚ â–¶ pdf_downloader.py      â”‚ â† PDF ä¸‹è½½ï¼ˆå·¨æ½®/SECï¼‰
    â”‚ â–¶ pdf_parser.py          â”‚ â† PDF â†’ TXT è½¬æ¢
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ•°æ®å¤„ç†å±‚               â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â–¶ calculator.py          â”‚ â† è´¢åŠ¡æŒ‡æ ‡è®¡ç®—
    â”‚ â–¶ validator.py           â”‚ â† æ•°æ®äº¤å‰éªŒè¯
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ•°æ®å­˜å‚¨å±‚ (SQLite)      â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ â€¢ financial_reports_raw  â”‚ â† åŸå§‹è´¢åŠ¡æ•°æ®
    â”‚ â€¢ financial_indicators_derived â”‚ â† è¡ç”ŸæŒ‡æ ‡
    â”‚ â€¢ financial_reports_filesâ”‚ â† æ–‡ä»¶è·¯å¾„è®°å½•
    â”‚ â€¢ metric_definitions     â”‚ â† æŒ‡æ ‡å­—å…¸
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
financial_report_scraper_antigravity/
â”œâ”€â”€ app.py                    # Streamlit ä¸»åº”ç”¨
â”œâ”€â”€ database.py               # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ data_fetcher.py           # AkShare æ•°æ®æŠ“å–å™¨
â”œâ”€â”€ calculator.py             # è´¢åŠ¡æŒ‡æ ‡è®¡ç®—å™¨
â”œâ”€â”€ pdf_downloader.py         # PDF ä¸‹è½½å™¨ï¼ˆå¤šå¸‚åœºæ”¯æŒï¼‰
â”œâ”€â”€ pdf_parser.py             # PDF â†’ TXT è§£æå™¨
â”œâ”€â”€ validator.py              # æ•°æ®äº¤å‰éªŒè¯å™¨
â”œâ”€â”€ finance.db                # SQLite æ•°æ®åº“ï¼ˆä¸è·Ÿè¸ªï¼‰
â”œâ”€â”€ downloads/                # ä¸‹è½½çš„ PDF/TXT æ–‡ä»¶ï¼ˆä¸è·Ÿè¸ªï¼‰
â”œâ”€â”€ requirements.txt          # Python ä¾èµ–
â”œâ”€â”€ README.md                 # æœ¬æ–‡æ¡£
â””â”€â”€ CHANGELOG.md              # å¼€å‘æ—¥å¿—
```

---

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### è¡¨ç»“æ„

#### 1. `financial_reports_raw` (åŸå§‹è´¢åŠ¡æ•°æ®)
å­˜å‚¨ä» AkShare æŠ“å–çš„åŸå§‹è´¢åŠ¡æ•°æ®ã€‚

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| stock_code | TEXT | è‚¡ç¥¨ä»£ç  |
| report_period | TEXT | æŠ¥å‘ŠæœŸ (å¦‚ 2023-12-31) |
| report_type | TEXT | æŠ¥å‘Šç±»å‹ (Q1/S1/Q3/A) |
| data_quality | TEXT | æ•°æ®è´¨é‡æ ‡è®° â­ |
| revenue | REAL | è¥ä¸šæ”¶å…¥ |
| total_assets | REAL | æ€»èµ„äº§ |
| ... | ... | å…¶ä»– 40+ è´¢åŠ¡å­—æ®µ |

#### 2. `financial_indicators_derived` (è¡ç”ŸæŒ‡æ ‡)
å­˜å‚¨è®¡ç®—å¾—å‡ºçš„è´¢åŠ¡æŒ‡æ ‡ã€‚

| å­—æ®µ | è¯´æ˜ |
|------|------|
| roe | å‡€èµ„äº§æ”¶ç›Šç‡ (%) |
| gross_margin | æ¯›åˆ©ç‡ (%) |
| revenue_yoy | è¥æ”¶å¢é•¿ç‡ (%) |
| ... | å…¶ä»– 15+ æŒ‡æ ‡ |

#### 3. `financial_reports_files` (æ–‡ä»¶è®°å½•) â­ æ–°å¢
è®°å½•ä¸‹è½½çš„è´¢æŠ¥æ–‡ä»¶ä¿¡æ¯ã€‚

| å­—æ®µ | è¯´æ˜ |
|------|------|
| file_path | PDF æ–‡ä»¶è·¯å¾„ |
| txt_path | è§£æåçš„ TXT è·¯å¾„ |
| parse_status | è§£æçŠ¶æ€ (SUCCESS/PENDING/FAILED) |

---

## ğŸ”¬ æŠ€æœ¯æ ˆ

- **å‰ç«¯**: [Streamlit](https://streamlit.io/) - å¿«é€Ÿæ„å»ºæ•°æ®åº”ç”¨
- **æ•°æ®æº**:
  - [AkShare](https://github.com/akfamily/akshare) - Aè‚¡æ•°æ®æ¥å£
  - [å·¨æ½®èµ„è®¯](http://www.cninfo.com.cn/) - å®˜æ–¹æŠ«éœ²å¹³å°
  - [SEC Edgar](https://www.sec.gov/edgar) - ç¾è‚¡è´¢æŠ¥
- **PDF å¤„ç†**: [PyMuPDF](https://pymupdf.readthedocs.io/) - PDF è§£æ
- **æ•°æ®åº“**: SQLite - è½»é‡çº§æœ¬åœ°å­˜å‚¨
- **æ•°æ®åˆ†æ**: Pandasã€NumPy

---

## ğŸ›£ï¸ Roadmap

### âœ… å·²å®Œæˆ (v1.0)
- [x] Aè‚¡æ•°æ®æŠ“å–ä¸å­˜å‚¨
- [x] è´¢åŠ¡æŒ‡æ ‡è‡ªåŠ¨è®¡ç®—
- [x] Streamlit æ•°æ®çœ‹æ¿
- [x] PDF ä¸‹è½½ä¸è§£æ
- [x] æ•°æ®äº¤å‰éªŒè¯å¼•æ“

### ğŸš§ è¿›è¡Œä¸­ (v1.1)
- [ ] Streamlit ç•Œé¢å¢åŠ "æŸ¥çœ‹åŸæ–‡"æŒ‰é’®
- [ ] æ”¯æŒæ¸¯è‚¡å’Œç¾è‚¡æ•°æ®å±•ç¤º
- [ ] å¢åŠ æ•°æ®è´¨é‡æ ‡è¯†æ˜¾ç¤º

### ğŸ“‹ è®¡åˆ’ä¸­ (v2.0)
- [ ] LLM é›†æˆï¼šæ™ºèƒ½è§£è¯»è´¢æŠ¥æ–‡æœ¬
- [ ] ç®¡ç†å±‚è®¨è®ºï¼ˆMD&Aï¼‰æå–ä¸æ€»ç»“
- [ ] è´¢æŠ¥æ™ºèƒ½é—®ç­”ï¼ˆQ&Aï¼‰
- [ ] å¤šè‚¡ç¥¨å¯¹æ¯”åˆ†æ
- [ ] æ•°æ®å¯¼å‡ºåŠŸèƒ½ï¼ˆExcel/CSVï¼‰

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æµç¨‹
1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

---

## ğŸ“„ License

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

---

## ğŸ™ è‡´è°¢

- [AkShare](https://github.com/akfamily/akshare) - æä¾›å…è´¹çš„ Aè‚¡æ•°æ®æ¥å£
- [Streamlit](https://streamlit.io/) - æä¾›ä¼˜ç§€çš„ Web æ¡†æ¶
- [Google Deepmind Antigravity](https://www.deepmind.google/) - AI è¾…åŠ©å¼€å‘å·¥å…·

---

## ğŸ“§ è”ç³»æ–¹å¼

- GitHub: [@aisong78](https://github.com/aisong78)
- é¡¹ç›®åœ°å€: [financial_report_scraper_antigravity](https://github.com/aisong78/financial_report_scraper_antigravity)

---

**âš ï¸ å…è´£å£°æ˜**: æœ¬å·¥å…·ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ä½¿ç”¨ï¼Œä¸æ„æˆä»»ä½•æŠ•èµ„å»ºè®®ã€‚æŠ•èµ„æœ‰é£é™©ï¼Œå†³ç­–éœ€è°¨æ…ã€‚
